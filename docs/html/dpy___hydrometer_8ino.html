<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hydrometer: C:/Users/minhc/Documents/CSE-4316/SourceCode/dpy_Hydrometer/dpy_Hydrometer.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hydrometer
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dpy___hydrometer_8ino.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dpy_Hydrometer.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is source file for DPY Hydrometer. This firmware file will setup the nRF52 based Bluefruit LE and Adafruit Adafruit_BNO055.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;bluefruit.h&gt;</code><br />
<code>#include &lt;Wire.h&gt;</code><br />
<code>#include &lt;Adafruit_Sensor.h&gt;</code><br />
<code>#include &lt;Adafruit_BNO055.h&gt;</code><br />
<code>#include &lt;utility/imumaths.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div>
<p><a href="dpy___hydrometer_8ino_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4c58310596eabbb970a4e2714e6e7077"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a4c58310596eabbb970a4e2714e6e7077">UUID16_HYDS</a>&#160;&#160;&#160;0x2468</td></tr>
<tr class="separator:a4c58310596eabbb970a4e2714e6e7077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac26005eeed930c3bea460993dae44f"><td class="memItemLeft" align="right" valign="top"><a id="aaac26005eeed930c3bea460993dae44f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UUID16_GRMC</b>&#160;&#160;&#160;0x0001</td></tr>
<tr class="separator:aaac26005eeed930c3bea460993dae44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101c08b06fa4c93c3c007bc0c6c307c0"><td class="memItemLeft" align="right" valign="top"><a id="a101c08b06fa4c93c3c007bc0c6c307c0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UUID16_CMDC</b>&#160;&#160;&#160;0x0002</td></tr>
<tr class="separator:a101c08b06fa4c93c3c007bc0c6c307c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18499e378c1e259cf6da0bf8ca0bcad8"><td class="memItemLeft" align="right" valign="top"><a id="a18499e378c1e259cf6da0bf8ca0bcad8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UUID16_BATC</b>&#160;&#160;&#160;0x0003</td></tr>
<tr class="separator:a18499e378c1e259cf6da0bf8ca0bcad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9c3045df8f60bc263718d85d25e9b2"><td class="memItemLeft" align="right" valign="top"><a id="a1f9c3045df8f60bc263718d85d25e9b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a1f9c3045df8f60bc263718d85d25e9b2">CMD_SET_INTERVAL</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="memdesc:a1f9c3045df8f60bc263718d85d25e9b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Command IDs for user app. <br /></td></tr>
<tr class="separator:a1f9c3045df8f60bc263718d85d25e9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e6ea987b017467c8e3e4b8ca12cc9a2"><td class="memItemLeft" align="right" valign="top"><a id="a7e6ea987b017467c8e3e4b8ca12cc9a2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CMD_GET_INTERVAL</b>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:a7e6ea987b017467c8e3e4b8ca12cc9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83040594ed47ff85392e95afa9583904"><td class="memItemLeft" align="right" valign="top"><a id="a83040594ed47ff85392e95afa9583904"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CMD_GET_CALIBRATION_STATUS</b>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:a83040594ed47ff85392e95afa9583904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12bd62363eeb212c7e52831e5324ce2e"><td class="memItemLeft" align="right" valign="top"><a id="a12bd62363eeb212c7e52831e5324ce2e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a12bd62363eeb212c7e52831e5324ce2e">BNO055_SAMPLERATE_DELAY_MS</a>&#160;&#160;&#160;(100)</td></tr>
<tr class="memdesc:a12bd62363eeb212c7e52831e5324ce2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sampling every 100 ms. <br /></td></tr>
<tr class="separator:a12bd62363eeb212c7e52831e5324ce2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ddd8f8ba527400d806a6b41eaa95be6"><td class="memItemLeft" align="right" valign="top"><a id="a7ddd8f8ba527400d806a6b41eaa95be6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a7ddd8f8ba527400d806a6b41eaa95be6">VBAT_PIN</a>&#160;&#160;&#160;(A7)</td></tr>
<tr class="memdesc:a7ddd8f8ba527400d806a6b41eaa95be6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adafruit batter pin. <br /></td></tr>
<tr class="separator:a7ddd8f8ba527400d806a6b41eaa95be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32579cd323a8ba465196a25d639d76b0"><td class="memItemLeft" align="right" valign="top"><a id="a32579cd323a8ba465196a25d639d76b0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a32579cd323a8ba465196a25d639d76b0">VBAT_MV_PER_LSB</a>&#160;&#160;&#160;(0.73242188F)</td></tr>
<tr class="memdesc:a32579cd323a8ba465196a25d639d76b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">3.0V ADC range and 12-bit ADC resolution = 3000mV/4096 <br /></td></tr>
<tr class="separator:a32579cd323a8ba465196a25d639d76b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5b55245198b5227a373ee381d26323"><td class="memItemLeft" align="right" valign="top"><a id="a2a5b55245198b5227a373ee381d26323"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a2a5b55245198b5227a373ee381d26323">VBAT_DIVIDER</a>&#160;&#160;&#160;(0.71275837F)</td></tr>
<tr class="memdesc:a2a5b55245198b5227a373ee381d26323"><td class="mdescLeft">&#160;</td><td class="mdescRight">2M + 0.806M voltage divider on VBAT = (2M / (0.806M + 2M)) <br /></td></tr>
<tr class="separator:a2a5b55245198b5227a373ee381d26323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df67a9ba10662cfca18bad82f435cb0"><td class="memItemLeft" align="right" valign="top"><a id="a2df67a9ba10662cfca18bad82f435cb0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a2df67a9ba10662cfca18bad82f435cb0">VBAT_DIVIDER_COMP</a>&#160;&#160;&#160;(1.403F)</td></tr>
<tr class="memdesc:a2df67a9ba10662cfca18bad82f435cb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compensation factor for the VBAT divider. <br /></td></tr>
<tr class="separator:a2df67a9ba10662cfca18bad82f435cb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa62ff3a008a19b54b094aa1b64d89b5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#aa62ff3a008a19b54b094aa1b64d89b5e">startAdv</a> (void)</td></tr>
<tr class="separator:aa62ff3a008a19b54b094aa1b64d89b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa440cb76248b5184c38d75f6c827bd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#aaa440cb76248b5184c38d75f6c827bd1">setupHYDS</a> (void)</td></tr>
<tr class="separator:aaa440cb76248b5184c38d75f6c827bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42328a2531f25c9a6be7653ef4a21c40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a42328a2531f25c9a6be7653ef4a21c40">connect_callback</a> (uint16_t conn_handle)</td></tr>
<tr class="separator:a42328a2531f25c9a6be7653ef4a21c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75d8e8b9b10b0a121eb72c75fe4ab1be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a75d8e8b9b10b0a121eb72c75fe4ab1be">disconnect_callback</a> (uint16_t conn_handle, uint8_t reason)</td></tr>
<tr class="separator:a75d8e8b9b10b0a121eb72c75fe4ab1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9700a9e1785dc46cc0e4b53c6115f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a2c9700a9e1785dc46cc0e4b53c6115f7">cccd_callback</a> (uint16_t conn_hdl, BLECharacteristic *chr, uint16_t cccd_value)</td></tr>
<tr class="separator:a2c9700a9e1785dc46cc0e4b53c6115f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df3a48c59f48a4950576d7960ddba8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a8df3a48c59f48a4950576d7960ddba8e">write_callback</a> (uint16_t conn_hdl, BLECharacteristic *chr, uint8_t *data, uint16_t len)</td></tr>
<tr class="separator:a8df3a48c59f48a4950576d7960ddba8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775f3ae8121fb2049e9d05b2dd72b5a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a775f3ae8121fb2049e9d05b2dd72b5a2">print_bytes</a> (byte *str, uint8_t len)</td></tr>
<tr class="separator:a775f3ae8121fb2049e9d05b2dd72b5a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300ecbf25a51953b52fe095d35664daa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a300ecbf25a51953b52fe095d35664daa">float2Bytes</a> (byte bytes_temp[4], float float_variable)</td></tr>
<tr class="separator:a300ecbf25a51953b52fe095d35664daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a7ebac4897fb3d7e369c917d632f08"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#ad4a7ebac4897fb3d7e369c917d632f08">mvToPercent</a> (float mvolts)</td></tr>
<tr class="separator:ad4a7ebac4897fb3d7e369c917d632f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647ec4ab0d27b1b384f76298bb1205f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a647ec4ab0d27b1b384f76298bb1205f5">readBatteryLevel</a> ()</td></tr>
<tr class="separator:a647ec4ab0d27b1b384f76298bb1205f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0e2bfaf37a2c519ba528c769277d08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#afa0e2bfaf37a2c519ba528c769277d08">getXYZ</a> ()</td></tr>
<tr class="separator:afa0e2bfaf37a2c519ba528c769277d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b1b253ee46df6a93285803cf1f3370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a95b1b253ee46df6a93285803cf1f3370">sendData</a> ()</td></tr>
<tr class="separator:a95b1b253ee46df6a93285803cf1f3370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9d552e06a464eace63641a49b654bf6f"><td class="memItemLeft" align="right" valign="top"><a id="a9d552e06a464eace63641a49b654bf6f"></a>
BLEService&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a9d552e06a464eace63641a49b654bf6f">hyds</a> = BLEService(<a class="el" href="dpy___hydrometer_8ino.html#a4c58310596eabbb970a4e2714e6e7077">UUID16_HYDS</a>)</td></tr>
<tr class="memdesc:a9d552e06a464eace63641a49b654bf6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the BLE service and characteristics. <br /></td></tr>
<tr class="separator:a9d552e06a464eace63641a49b654bf6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31955613e775bdeb046910662fdead4d"><td class="memItemLeft" align="right" valign="top"><a id="a31955613e775bdeb046910662fdead4d"></a>
BLECharacteristic&#160;</td><td class="memItemRight" valign="bottom"><b>grmc</b> = BLECharacteristic(UUID16_GRMC)</td></tr>
<tr class="separator:a31955613e775bdeb046910662fdead4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5595b4e322d91752525a04ef2a7f05"><td class="memItemLeft" align="right" valign="top"><a id="a6b5595b4e322d91752525a04ef2a7f05"></a>
BLECharacteristic&#160;</td><td class="memItemRight" valign="bottom"><b>cmdc</b> = BLECharacteristic(UUID16_CMDC)</td></tr>
<tr class="separator:a6b5595b4e322d91752525a04ef2a7f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf9190dccefa5fbcc0bee76ecddbb43"><td class="memItemLeft" align="right" valign="top"><a id="afdf9190dccefa5fbcc0bee76ecddbb43"></a>
BLECharacteristic&#160;</td><td class="memItemRight" valign="bottom"><b>batc</b> = BLECharacteristic(UUID16_BATC)</td></tr>
<tr class="separator:afdf9190dccefa5fbcc0bee76ecddbb43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3df856729b3af3070dfca595f9accd4"><td class="memItemLeft" align="right" valign="top"><a id="ab3df856729b3af3070dfca595f9accd4"></a>
BLEDis&#160;</td><td class="memItemRight" valign="bottom"><b>bledis</b></td></tr>
<tr class="separator:ab3df856729b3af3070dfca595f9accd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29527d634dcee290fa1ef384d2dadf9"><td class="memItemLeft" align="right" valign="top"><a id="af29527d634dcee290fa1ef384d2dadf9"></a>
BLEBas&#160;</td><td class="memItemRight" valign="bottom"><b>blebas</b></td></tr>
<tr class="separator:af29527d634dcee290fa1ef384d2dadf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9679047c6a38d1e13f18dc4dbc2d3389"><td class="memItemLeft" align="right" valign="top"><a id="a9679047c6a38d1e13f18dc4dbc2d3389"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>grmInterval</b> = 5</td></tr>
<tr class="separator:a9679047c6a38d1e13f18dc4dbc2d3389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade995ab2b812c0de1a76d6ad7b5ab0c0"><td class="memItemLeft" align="right" valign="top"><a id="ade995ab2b812c0de1a76d6ad7b5ab0c0"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>notifyEnable</b> = 0</td></tr>
<tr class="separator:ade995ab2b812c0de1a76d6ad7b5ab0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addce0e642c581c60f51b5bdc664f1297"><td class="memItemLeft" align="right" valign="top"><a id="addce0e642c581c60f51b5bdc664f1297"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>toggleRedLED</b> = 0</td></tr>
<tr class="separator:addce0e642c581c60f51b5bdc664f1297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9ffe3deced12d13c7fee18b5733890"><td class="memItemLeft" align="right" valign="top"><a id="aeb9ffe3deced12d13c7fee18b5733890"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>cmdData</b> [5]</td></tr>
<tr class="separator:aeb9ffe3deced12d13c7fee18b5733890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce2e19f4288e6517e0f0e2933bb1f85"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a9ce2e19f4288e6517e0f0e2933bb1f85">thetaM</a></td></tr>
<tr class="separator:a9ce2e19f4288e6517e0f0e2933bb1f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba30de0897ce239d95a052dbe9b25a7d"><td class="memItemLeft" align="right" valign="top"><a id="aba30de0897ce239d95a052dbe9b25a7d"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phiM</b></td></tr>
<tr class="separator:aba30de0897ce239d95a052dbe9b25a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d3f4f8791012857a7b27a1f9e4e9cd"><td class="memItemLeft" align="right" valign="top"><a id="af4d3f4f8791012857a7b27a1f9e4e9cd"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>thetaFold</b> = 0</td></tr>
<tr class="separator:af4d3f4f8791012857a7b27a1f9e4e9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82152e7967f8035ccffaa2628e74d79a"><td class="memItemLeft" align="right" valign="top"><a id="a82152e7967f8035ccffaa2628e74d79a"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>thetaFnew</b></td></tr>
<tr class="separator:a82152e7967f8035ccffaa2628e74d79a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f92d040cab8d5619780bc0db9c6057"><td class="memItemLeft" align="right" valign="top"><a id="af9f92d040cab8d5619780bc0db9c6057"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phiFold</b> = 0</td></tr>
<tr class="separator:af9f92d040cab8d5619780bc0db9c6057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a2c46c03f94bf1b4b9a2dfbc2aaa51"><td class="memItemLeft" align="right" valign="top"><a id="a19a2c46c03f94bf1b4b9a2dfbc2aaa51"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phiFnew</b></td></tr>
<tr class="separator:a19a2c46c03f94bf1b4b9a2dfbc2aaa51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4474e86ec1a568363b22737d2dce0536"><td class="memItemLeft" align="right" valign="top"><a id="a4474e86ec1a568363b22737d2dce0536"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a4474e86ec1a568363b22737d2dce0536">thetaG</a> = 0</td></tr>
<tr class="memdesc:a4474e86ec1a568363b22737d2dce0536"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gyrospoce variables for angle measurement. <br /></td></tr>
<tr class="separator:a4474e86ec1a568363b22737d2dce0536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f33fa66af1e942d8be166cd26add13"><td class="memItemLeft" align="right" valign="top"><a id="af4f33fa66af1e942d8be166cd26add13"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phiG</b> = 0</td></tr>
<tr class="separator:af4f33fa66af1e942d8be166cd26add13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a778e38aa889751afffa2dea6b803e67a"><td class="memItemLeft" align="right" valign="top"><a id="a778e38aa889751afffa2dea6b803e67a"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>dt</b></td></tr>
<tr class="separator:a778e38aa889751afffa2dea6b803e67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44dddd37bc731b0e1aa83bb75f502e83"><td class="memItemLeft" align="right" valign="top"><a id="a44dddd37bc731b0e1aa83bb75f502e83"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>millisOld</b></td></tr>
<tr class="separator:a44dddd37bc731b0e1aa83bb75f502e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfc5c227ca658a29a59a0ce6fc15792"><td class="memItemLeft" align="right" valign="top"><a id="aadfc5c227ca658a29a59a0ce6fc15792"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#aadfc5c227ca658a29a59a0ce6fc15792">theta</a></td></tr>
<tr class="memdesc:aadfc5c227ca658a29a59a0ce6fc15792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final overall measurement after combining accelerometer and gyrospoce data. <br /></td></tr>
<tr class="separator:aadfc5c227ca658a29a59a0ce6fc15792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab30c622a174639ec92b375db9b2ee56d"><td class="memItemLeft" align="right" valign="top"><a id="ab30c622a174639ec92b375db9b2ee56d"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phi</b></td></tr>
<tr class="separator:ab30c622a174639ec92b375db9b2ee56d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5395db680075033b859646233c201ff"><td class="memItemLeft" align="right" valign="top"><a id="af5395db680075033b859646233c201ff"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#af5395db680075033b859646233c201ff">thetaRad</a></td></tr>
<tr class="memdesc:af5395db680075033b859646233c201ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Angles in radians. <br /></td></tr>
<tr class="separator:af5395db680075033b859646233c201ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10404e95ea50aa9238abc006892e0726"><td class="memItemLeft" align="right" valign="top"><a id="a10404e95ea50aa9238abc006892e0726"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>phiRad</b></td></tr>
<tr class="separator:a10404e95ea50aa9238abc006892e0726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a59fef582e830568602c08472d89765"><td class="memItemLeft" align="right" valign="top"><a id="a8a59fef582e830568602c08472d89765"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a8a59fef582e830568602c08472d89765">Xm</a></td></tr>
<tr class="memdesc:a8a59fef582e830568602c08472d89765"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variables to calculate Z axis angle. <br /></td></tr>
<tr class="separator:a8a59fef582e830568602c08472d89765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d7d90b2b5247f1db58ced67a03fa2b"><td class="memItemLeft" align="right" valign="top"><a id="a86d7d90b2b5247f1db58ced67a03fa2b"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>Ym</b></td></tr>
<tr class="separator:a86d7d90b2b5247f1db58ced67a03fa2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace8e2df2e07a1def1b869e5511bc602"><td class="memItemLeft" align="right" valign="top"><a id="aace8e2df2e07a1def1b869e5511bc602"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>psi</b></td></tr>
<tr class="separator:aace8e2df2e07a1def1b869e5511bc602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93e674939d1abc876558b3a692f3a55"><td class="memItemLeft" align="right" valign="top"><a id="af93e674939d1abc876558b3a692f3a55"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#af93e674939d1abc876558b3a692f3a55">cal_system</a></td></tr>
<tr class="memdesc:af93e674939d1abc876558b3a692f3a55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variables used for calibration. <br /></td></tr>
<tr class="separator:af93e674939d1abc876558b3a692f3a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e19362553dfb5bc491937c5b40a89e"><td class="memItemLeft" align="right" valign="top"><a id="aa4e19362553dfb5bc491937c5b40a89e"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>cal_gyroo</b></td></tr>
<tr class="separator:aa4e19362553dfb5bc491937c5b40a89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b1a0f3ac2ad6a3143e77e3213f40d43"><td class="memItemLeft" align="right" valign="top"><a id="a5b1a0f3ac2ad6a3143e77e3213f40d43"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>cal_accel</b></td></tr>
<tr class="separator:a5b1a0f3ac2ad6a3143e77e3213f40d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ad5409872160e7097c79f730211f67"><td class="memItemLeft" align="right" valign="top"><a id="ab3ad5409872160e7097c79f730211f67"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>cal_mg</b> = 0</td></tr>
<tr class="separator:ab3ad5409872160e7097c79f730211f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a311b50e0cc912b6e354bdca38279a"><td class="memItemLeft" align="right" valign="top"><a id="ad7a311b50e0cc912b6e354bdca38279a"></a>
Adafruit_BNO055&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#ad7a311b50e0cc912b6e354bdca38279a">myIMU</a> = Adafruit_BNO055()</td></tr>
<tr class="memdesc:ad7a311b50e0cc912b6e354bdca38279a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creating an object. <br /></td></tr>
<tr class="separator:ad7a311b50e0cc912b6e354bdca38279a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4a69cbf0bb0db4637fcd6e2368ae71"><td class="memItemLeft" align="right" valign="top"><a id="a3f4a69cbf0bb0db4637fcd6e2368ae71"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>vbat_raw</b></td></tr>
<tr class="separator:a3f4a69cbf0bb0db4637fcd6e2368ae71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf50989973c0ca4d7477a0536c07223"><td class="memItemLeft" align="right" valign="top"><a id="a9cf50989973c0ca4d7477a0536c07223"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>vbat_per</b></td></tr>
<tr class="separator:a9cf50989973c0ca4d7477a0536c07223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae8d8eca3ea3f4c408916bd682c65772"><td class="memItemLeft" align="right" valign="top"><a id="aae8d8eca3ea3f4c408916bd682c65772"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>vbat_mv</b></td></tr>
<tr class="separator:aae8d8eca3ea3f4c408916bd682c65772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18d6f8298def612b5914743f968fbaf3"><td class="memItemLeft" align="right" valign="top"><a id="a18d6f8298def612b5914743f968fbaf3"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>countDown</b></td></tr>
<tr class="separator:a18d6f8298def612b5914743f968fbaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a094eb1ed82909d61058da07ddda76ba7"><td class="memItemLeft" align="right" valign="top"><a id="a094eb1ed82909d61058da07ddda76ba7"></a>
int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dpy___hydrometer_8ino.html#a094eb1ed82909d61058da07ddda76ba7">tempFahrenheit</a></td></tr>
<tr class="memdesc:a094eb1ed82909d61058da07ddda76ba7"><td class="mdescLeft">&#160;</td><td class="mdescRight">countdown interval to get data <br  />
 <br /></td></tr>
<tr class="separator:a094eb1ed82909d61058da07ddda76ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is source file for DPY Hydrometer. This firmware file will setup the nRF52 based Bluefruit LE and Adafruit Adafruit_BNO055. </p>
<dl class="section author"><dt>Author</dt><dd>Minh Luong </dd></dl>

<p class="definition">Definition in file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4c58310596eabbb970a4e2714e6e7077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c58310596eabbb970a4e2714e6e7077">&#9670;&nbsp;</a></span>UUID16_HYDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UUID16_HYDS&#160;&#160;&#160;0x2468</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>HYDROMETER Service Definitions Hydrometer Service: 0x2468 Gravity Measurement Char: 0x0001 Battery Level Measurement Char: 0x0002 </p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00021">21</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2c9700a9e1785dc46cc0e4b53c6115f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c9700a9e1785dc46cc0e4b53c6115f7">&#9670;&nbsp;</a></span>cccd_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cccd_callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_hdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BLECharacteristic *&#160;</td>
          <td class="paramname"><em>chr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>cccd_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback invoked when user subscribed to the gravity characteristic </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_hdl</td><td>connection where this event happens </td></tr>
    <tr><td class="paramname">chr</td><td>the characteristic pointer </td></tr>
    <tr><td class="paramname">cccd_value</td><td>the cccd value </td></tr>
  </table>
  </dd>
</dl>
<p>Display the raw request packet</p>
<p>Check the characteristic this CCCD update is associated with in case this handler is used for multiple CCCD records.</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00252">252</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a42328a2531f25c9a6be7653ef4a21c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42328a2531f25c9a6be7653ef4a21c40">&#9670;&nbsp;</a></span>connect_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connect_callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback invoked when a connection is established </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_handle</td><td>connection where this event happens </td></tr>
  </table>
  </dd>
</dl>
<p>Get the reference to current connection</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00220">220</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a75d8e8b9b10b0a121eb72c75fe4ab1be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75d8e8b9b10b0a121eb72c75fe4ab1be">&#9670;&nbsp;</a></span>disconnect_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disconnect_callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback invoked when a connection is dropped </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_handle</td><td>connection where this event happens </td></tr>
    <tr><td class="paramname">reason</td><td>is a BLE_HCI_STATUS_CODE which can be found in ble_hci.h </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00237">237</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a300ecbf25a51953b52fe095d35664daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300ecbf25a51953b52fe095d35664daa">&#9670;&nbsp;</a></span>float2Bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void float2Bytes </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>bytes_temp</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>float_variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will convert the float value to array of bytes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytes_temp</td><td>the array of output bytes </td></tr>
    <tr><td class="paramname">float_variable</td><td>the float value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00337">337</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="afa0e2bfaf37a2c519ba528c769277d08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0e2bfaf37a2c519ba528c769277d08">&#9670;&nbsp;</a></span>getXYZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getXYZ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will read X, Y, and Z values from Accelerometer, Gyroscope, and Magnetometer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Compact datatype = int8_t</p>
<p>Using the external temperature sensor that is on the board and not the one on the chip.</p>
<p>Ranging from level 0-3 = CALIBRATION</p>
<p>Calculating theta in degrees = Tilt (accelerometer)</p>
<p>Low pass fiter data</p>
<p>Final measurement for theta(x) and phi(y)</p>
<p>Finding angle using gyroscope measurements</p>
<p>Converting the angle in radians</p>
<p>Using magnetometer data, finding the z-axis angle</p>
<p>Print Statements</p>
<p>Setting back the value to new value(0) while going back to loop</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00401">401</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is main loop of firmware </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Only send update once per second</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00549">549</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="ad4a7ebac4897fb3d7e369c917d632f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a7ebac4897fb3d7e369c917d632f08">&#9670;&nbsp;</a></span>mvToPercent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t mvToPercent </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>mvolts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will convert battery voltage to level </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mvolts</td><td>the current voltage of battery <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the battery level </dd></dl>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00351">351</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a775f3ae8121fb2049e9d05b2dd72b5a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a775f3ae8121fb2049e9d05b2dd72b5a2">&#9670;&nbsp;</a></span>print_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_bytes </td>
          <td>(</td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will print out the data in Hex format </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>the array of byte data </td></tr>
    <tr><td class="paramname">len</td><td>the input data length </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00325">325</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a647ec4ab0d27b1b384f76298bb1205f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a647ec4ab0d27b1b384f76298bb1205f5">&#9670;&nbsp;</a></span>readBatteryLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readBatteryLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will read the battery voltage from output pin </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Read battery voltage from output pin</p>
<p>FIXME: Using C-style cast. Use static_cast&lt;float&gt;(...) instead [readability/casting] [4] Remove [readability/casting] ignore from Makefile</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00375">375</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a95b1b253ee46df6a93285803cf1f3370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95b1b253ee46df6a93285803cf1f3370">&#9670;&nbsp;</a></span>sendData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will send the gravity data to user side </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Note: We use .notify instead of .write! If it is connected but CCCD is not enabled The characteristic's value is still updated although notification is not sent</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00508">508</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will setup all devices </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>for nrf52840 with native usb</p>
<p>Initialise the Bluefruit module</p>
<p>Set the advertised device name (keep it short!)</p>
<p>Set the connect/disconnect callback handlers</p>
<p>Configure and Start the Device Information Service</p>
<p>Start the BLE Battery Service and set it to 100%</p>
<p>Setup the Heart Rate Monitor service using BLEService and BLECharacteristic classes</p>
<p>Setup the advertising packet(s)</p>
<p>Can be 8, 10, 12 or 14</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00104">104</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="aaa440cb76248b5184c38d75f6c827bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa440cb76248b5184c38d75f6c827bd1">&#9670;&nbsp;</a></span>setupHYDS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setupHYDS </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will setup all characteristics </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Setup for Gravity Measurement Characteristic</p>
<p>Optionally capture CCCD updates</p>
<p>Setup for Command Characteristic</p>
<p>Set up battery level characterristics</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00191">191</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="aa62ff3a008a19b54b094aa1b64d89b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa62ff3a008a19b54b094aa1b64d89b5e">&#9670;&nbsp;</a></span>startAdv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startAdv </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will setup and start the BLE advertising </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Advertising packet</p>
<p>Include HRM Service UUID</p>
<p>Include Name</p>
<p>Start Advertising</p><ul>
<li>Enable auto advertising if disconnected</li>
<li>Interval: fast mode = 20 ms, slow mode = 152.5 ms</li>
<li>Timeout for fast mode is 30 seconds</li>
<li>Start(timeout) with timeout = 0 will advertise forever (until connected)</li>
</ul>
<p>For recommended advertising interval <a href="https://developer.apple.com/library/content/qa/qa1931/_index.html">https://developer.apple.com/library/content/qa/qa1931/_index.html</a> <br  />
</p>
<p>in unit of 0.625 ms</p>
<p>number of seconds in fast mode</p>
<p>0 = Don't stop advertising after n seconds <br  />
</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00160">160</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<a id="a8df3a48c59f48a4950576d7960ddba8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df3a48c59f48a4950576d7960ddba8e">&#9670;&nbsp;</a></span>write_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>conn_hdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BLECharacteristic *&#160;</td>
          <td class="paramname"><em>chr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback invoked when user wrote to command characteristic </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_hdl</td><td>connection where this event happens </td></tr>
    <tr><td class="paramname">chr</td><td>the characteristic pointer </td></tr>
    <tr><td class="paramname">data</td><td>the pointer to the input data </td></tr>
    <tr><td class="paramname">len</td><td>the input data length </td></tr>
  </table>
  </dd>
</dl>
<p>Set the interval for the notification characteristic</p>
<p>Get the previous interval for the notification characteristic</p>
<p>Get the hardware calibration status</p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00279">279</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9ce2e19f4288e6517e0f0e2933bb1f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce2e19f4288e6517e0f0e2933bb1f85">&#9670;&nbsp;</a></span>thetaM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float thetaM</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Variable to determine the tilt from the 3 axis accelerometer for angle measurement Accelerometer variables </p>

<p class="definition">Definition at line <a class="el" href="dpy___hydrometer_8ino_source.html#l00062">62</a> of file <a class="el" href="dpy___hydrometer_8ino_source.html">dpy_Hydrometer.ino</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_ac017a77f4e9fbb8feb31211a35b61da.html">minhc</a></li><li class="navelem"><a class="el" href="dir_4328db08a9585e79e7a10496dfb1643c.html">Documents</a></li><li class="navelem"><a class="el" href="dir_851a4e705a8c91043235f7a613e76e57.html">CSE-4316</a></li><li class="navelem"><a class="el" href="dir_706131582e615f7b06cb69ef381d18bc.html">SourceCode</a></li><li class="navelem"><a class="el" href="dir_3e427d0e77c50a011a6aa03de0a3aa33.html">dpy_Hydrometer</a></li><li class="navelem"><a class="el" href="dpy___hydrometer_8ino.html">dpy_Hydrometer.ino</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
